[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Investigating the Relationship Between Air Quality and Cancer Incidence in the United States",
    "section": "",
    "text": "1 Introduction\nTitle: Investigating the Relationship Between Air Quality and Lung and Bronchus Cancer in the United States\nWhy Choose This Topic:\n\nPublic Health Impact: Lung and Bronchus is a leading cause of death globally, and its incidence is on the rise. Investigating the relationship between cancer and air quality can provide insights into environmental factors contributing to Lung and Bronchus cancer risk.\nEnvironmental Concerns: Air quality affects the health of millions of people. Poor air quality, characterized by pollutants like particulate matter (PM) has been associated with various health problems, including respiratory and cardiovascular diseases.\nPolicy Implications: Understanding the link between air quality and Lung and Bronchus cancer can inform evidence-based policies and regulations aimed at reducing Lung and Bronchus cancer rates by improving air quality. This research can contribute to more effective public health strategies.\n\nQuestions we are interested in studying:\n\nWhether certain states have higher Lung and Bronchus cancer rate? What are the trends in Lung and Bronchus cancer incidence and air quality over time?\nDetermine if there are geographical areas in the United States with consistently poor air quality and elevated Lung and Bronchus cancer rates. Are there any outliers in terms of cancer incidence or air quality?\nWhether there is a statistically significant correlation between long-term exposure to poor air quality (measured by pollutants like PM2.5 and ozone) and the incidence of Lung and Bronchus cancer in different regions of the United States?\n\nContext About the Measurement of Air Quality:\nWe would assess air quality using various measurements, including:\n\nDaily Ozone Concentrations Daily ozone concentrations in our dataset refer to the levels of ozone (O3) gas within 3 meters of the surface of the earth measured on a daily basis. Ozone is a reactive gas composed of three oxygen atoms (O3), and it is a key component of Earth’s atmosphere. While ozone high in the stratosphere (stratospheric ozone) plays a crucial role in protecting us from harmful ultraviolet (UV) radiation from the sun, ozone at ground level (tropospheric ozone) is an air pollutant that can have health and environmental impacts. In our research, ozone within 3 meters of the surface of the earth stand for ground level ozone and thus we expect a negative impact on human health.\nDaily PM2.5 Concentrations Daily PM2.5 concentrations refer to the levels of fine particulate matter (PM2.5) in the air measured on a daily basis. PM2.5 refers to tiny airborne particles or aerosols with a diameter of 2.5 micrometers or smaller. These particles are so small that they can be inhaled deeply into the lungs and even enter the bloodstream, posing health risks to humans."
  },
  {
    "objectID": "data.html#technical-description",
    "href": "data.html#technical-description",
    "title": "2  Data",
    "section": "2.1 Technical description",
    "text": "2.1 Technical description\nData Source 1: The first dataset we use is the United States Cancer Statistics (USCS) from the CDC’s WONDER database(https://wonder.cdc.gov/cancer-v2020.HTML). It includes cancer incidence data for the United States. These data are collected and provided by the CDC’s National Program of Cancer Registries (NPCR) and the National Cancer Institute’s Surveillance, Epidemiology and End Results (SEER) program. From the previous archived Cancer Statistics data, we can tell that the dataset is updated each year. The data contains 9 variables, including location, year, age group, race, sex, ethnicity, leading cancer sites, cancer sites, and childhood cancers. Also, the dataset covers years 1999 to 2020, with the 2022 data submission released in 2023. For our research, we focus on data from 2001 to 2011, centering on specific variables states and Lung and Bronchus cancer counts among 100k people. The final dimension of the cancer data is 5918 * 11. This selection enables us to analyze trends and patterns relevant to our study’s objectives. However, the dataset presents a challenge in its usage: it does not allow direct downloading in CSV format. Instead, we must employ the website’s query feature to select desired columns and export them as a TXT file. To make this data compatible with our analytical tools, we use R to transform the file into a CSV format, facilitating efficient data manipulation and analysis. This conversion process is crucial for extracting meaningful insights from the dataset, which includes data on the total population, cancer incidence, and crude rates.\n\n\nCode\nlibrary(readr)\n\ndata &lt;- read.table(file = 'United States Cancer Statistics, 2002-2011 Incidence.txt', \n                   header = TRUE, \n                   fill = TRUE, \n                   strip.white = TRUE, \n                   sep = \"\")\ndata &lt;- data[, -ncol(data)]\nnames(data)[ncol(data)] &lt;- 'Crude Rate'\nwrite_csv(data, 'cancer.csv')\n\n\nData Source 2: Daily PM2.5 Concentrations All County, 2001-2016 LINK: https://data.cdc.gov/Environmental-Health-Toxicology/Daily-PM2-5-Concentrations-All-County-2001-2016/7vdq-ztk9 This data set is collected by CDC National Environmental Public Health Tracking Network. It provides modeled predictions of PM2.5 levels from the EPA’s Downscaler model. Data are at the county level for year 2001-2016. The dataset includes the maximum, median, mean, and population-weighted mean of 24-hour average PM2.5 concentration in μg/m3. This data set is in csv format. It was created on March 25, 2020 and last updated on January 21, 2021. Original Data Dimension: 18.2M rows and 8 columns. Since this dataset is too large, I wouldn’t be able to directly download and import from the Centers for Disease Control and Prevention website. Also, to compare with cancer incidence over time, it’s better to let both datasets have the same time division (i.e., by year) and same geographical division(i.e., by state), it ensures consistency in the temporal granularity of the data. Thus, I will first group by year and state and aggregate on the PM25_max_pred and PM25_pop_pred columns to make the row number smaller using the query tools on the website and then import using API endpoint.\n\n\nCode\npm &lt;- read.csv(\"https://data.cdc.gov/resource/7vdq-ztk9.csv?$query=SELECT%0A%20%20%60year%60%2C%0A%20%20%60statefips%60%2C%0A%20%20max(%60pm25_max_pred%60)%20AS%20%60max_pm25_max_pred%60%2C%0A%20%20avg(%60pm25_pop_pred%60)%20AS%20%60avg_pm25_pop_pred%60%0AGROUP%20BY%20%60year%60%2C%20%60statefips%60\")\n\n\nData Source 3: Daily County-Level Ozone Concentrations, 2001-2016 LINK: https://data.cdc.gov/Environmental-Health-Toxicology/Daily-County-Level-Ozone-Concentrations-2001-2016/kmf5-t9yc This data set is collected by CDC National Environmental Public Health Tracking Network. Data are at the county levels for years 2001-2014. The dataset includes the maximum, median, mean, and population-weighted mean estimated 8-hour average ozone concentration in parts per billion (ppb) within 3 meters of the surface of the earth. This data set is in csv format. It was created on March 11, 2020 and last updated on May 21, 2020. Original Data Dimension: 18.2M rows and 9 columns Since the data set is too large, I wouldn’t be able to directly download and import from the Centers for Disease Control and Prevention website. For the consistency purpose mentioned above, I will first group by year and state and aggregate on 03_max_pred and O3_pop_pred columns to make the row number smaller using the query tools on the website and then import using API endpoint.\n\n\nCode\nozone &lt;- read.csv(\"https://data.cdc.gov/resource/kmf5-t9yc.csv?$query=SELECT%0A%20%20%60year2%60%2C%0A%20%20%60statefips%60%2C%0A%20%20max(%60o3_max_pred%60)%20AS%20%60max_o3_max_pred%60%2C%0A%20%20avg(%60o3_pop_pred%60)%20AS%20%60avg_o3_pop_pred%60%0AGROUP%20BY%20%60year2%60%2C%20%60statefips%60\")"
  },
  {
    "objectID": "data.html#research-plan",
    "href": "data.html#research-plan",
    "title": "2  Data",
    "section": "2.2 Research plan",
    "text": "2.2 Research plan\nTo answer what are the trends in Lung and Bronchus Cancer incidence and air quality over time, we need:\n\nDescriptive Statistics: Generate basic statistics (mean, median, variance, etc.) for cancer rates, PM2.5, and ozone levels.\nTime Series Plots: Look for trends over time in each dataset. Create time series plots for cancer incidence, PM2.5, and ozone levels for each state.\n\nTo answer how do air quality and Lung and Bronchus Cancer rates vary across states, we need:\n\nBox plots to get a summary of air quality data and cancer incidence for multiple regions in a compact format. Each box plot represents a region, and the boxes display the distribution of air quality values (e.g., median, quartiles). Regions with consistently poor air quality will have lower medians and wider interquartile ranges.\nBar charts to compare cancer incidence rates for different cancer subtypes across states. Each subtype can be represented by a different color, and states can be grouped along the x-axis. As we have a large dataset about cancer incidence, we will need interactive plots to provide additional insights and allow us to zoom in on specific data points.\nHeatmap to visualize air quality data across both time and regions. Rows represent regions, columns represent time intervals, and the color scale indicates air quality levels. Consistently poor air quality regions will be represented by darker colors on the heatmap.\n\nTo answer whether there is any correlation between PM2.5 and ozone and the incidence of Lung and Bronchus cancer in different regions of the United States, we would:\n\nCompare the time series line we got for cancer incidence with the line we got for air condition. Make scatter plots to visualize the relationship between air quality indices and cancer rates.\nPerform hypothesis testing using Pearson’s correlation test and get a statistical result based on p-value."
  },
  {
    "objectID": "data.html#missing-value-analysis",
    "href": "data.html#missing-value-analysis",
    "title": "2  Data",
    "section": "2.3 Missing value analysis",
    "text": "2.3 Missing value analysis\nLoad required libraries\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(tidyverse)\nlibrary(mi)\nlibrary(redav)\n\n\nFor the cancer dataset, from the description of the website, all missing and null values are shown as “Missing” in the dataset. Here I convert all “Missing” values to NA and show them in graph.\n\n\nCode\ndata &lt;- data %&gt;%\n  mutate(across(where(is.character), ~na_if(., \"Missing\")))\n\n\n\n\nCode\ncolSums(is.na(data))\n\n\n     Leading.Cancer.Sites Leading.Cancer.Sites.Code                    States \n                        0                         0                         0 \n              States.Code                      Year                 Year.Code \n                        0                         0                         0 \n                      Sex                  Sex.Code                     Count \n                        0                         0                        12 \n               Population                Crude Rate \n                       12                        12 \n\n\nIt seems like the number of null values in the cancer data frame is not large. Here we want to find which rows contains the null values.\n\n\nCode\n# Get the row indices that have any NA values\nna_rows &lt;- which(apply(is.na(data), 1, any), arr.ind=TRUE)\nselected_rows &lt;- data[na_rows, ]\nselected_rows\n\n\n               Leading.Cancer.Sites Leading.Cancer.Sites.Code      States\n467  Brain and Other Nervous System               31010-31040 Mississippi\n468  Brain and Other Nervous System               31010-31040 Mississippi\n1478        Kidney and Renal Pelvis                     29020 Mississippi\n1479        Kidney and Renal Pelvis                     29020 Mississippi\n2440                         Larynx                     22020 Mississippi\n2441                         Larynx                     22020 Mississippi\n3351              Lung and Bronchus                     22030 Mississippi\n3352              Lung and Bronchus                     22030 Mississippi\n4369           Melanoma of the Skin                     25010 Mississippi\n4370           Melanoma of the Skin                     25010 Mississippi\n5384        Oral Cavity and Pharynx               20010-20100 Mississippi\n5385        Oral Cavity and Pharynx               20010-20100 Mississippi\n     States.Code Year Year.Code    Sex Sex.Code Count Population Crude Rate\n467           28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n468           28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n1478          28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n1479          28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n2440          28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n2441          28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n3351          28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n3352          28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n4369          28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n4370          28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n5384          28 2002      2002 Female        F  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n5385          28 2002      2002   Male        M  &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;\n\n\nFrom the graph we find that all values of count, population and crude rate in 2002 and Mississippi are missing.\n\n\nCode\nx &lt;- missing_data.frame(data)\n\n\nNOTE: The following pairs of variables appear to have the same missingness pattern.\n Please verify whether they are in fact logically distinct variables.\n     [,1]         [,2]        \n[1,] \"Count\"      \"Population\"\n[2,] \"Count\"      \"Crude Rate\"\n[3,] \"Population\" \"Crude Rate\"\n\n\nWarning in .local(.Object, ...): States and States.Code have the same rank ordering.\n Please verify whether they are in fact distinct variables.\n\n\nWarning in .local(.Object, ...): Year and Year.Code have the same rank ordering.\n Please verify whether they are in fact distinct variables.\n\n\nWarning in .local(.Object, ...): Sex and Sex.Code have the same rank ordering.\n Please verify whether they are in fact distinct variables.\n\n\nCode\nimage(x)\n\n\n\n\n\n\n\nCode\nplot_missing(data, percent = FALSE)\n\n\n\n\n\nCode\nlevels(x@patterns)\n\n\n[1] \"nothing\"                       \"Count, Population, Crude.Rate\"\n\n\nCode\nsummary(x@patterns)\n\n\n                      nothing Count, Population, Crude.Rate \n                         5906                            12 \n\n\nFrom the graph we can see that only columns of count, population, and crude rate have missing values. And all missing values are from the state of Mississipi during the year of 2002.\nFor the PM2.5 Concentrations dataset:\n\n\nCode\ncolSums(is.na (pm) ) |&gt; sort(decreasing = TRUE)\n\n\n             year         statefips max_pm25_max_pred avg_pm25_pop_pred \n                0                 0                 0                 0 \n\n\n\n\nCode\nplot_missing(pm, percent = FALSE)\n\n\n\n\n\nBased on the missing pattern graph and the NA count in the dataset, there is no missing values.\nFor the Ozone Concentrations dataset:\n\n\nCode\ncolSums(is.na (ozone) ) |&gt; sort(decreasing = TRUE)\n\n\n          year2       statefips max_o3_max_pred avg_o3_pop_pred \n              0               0               0               0 \n\n\n\n\nCode\nplot_missing(ozone, percent = FALSE)\n\n\n\n\n\nBased on the missing pattern graph and the NA count in the dataset, there is no missing values."
  },
  {
    "objectID": "results.html#time-series-analysis",
    "href": "results.html#time-series-analysis",
    "title": "3  Results",
    "section": "3.1 Time series Analysis",
    "text": "3.1 Time series Analysis\nLoad required libraries\n\n\nCode\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(sf)\nlibrary(choroplethr)\nlibrary(parcoords)\nlibrary(gridExtra)\nlibrary(plotly)\n\n\nMerge cancer, PM2.5, and Ozone data by year and states.\n\n\nCode\ncancer &lt;- read.csv('cancer.csv')\n#unique(cancer$Leading.Cancer.Sites)\ncancer$Count &lt;- as.numeric(as.character(cancer$Count))\ncancer$Population &lt;- as.numeric(cancer$Population)\ncancer &lt;- na.omit(cancer)\nlung_df = cancer[cancer['Leading.Cancer.Sites'] == 'Lung and Bronchus',]\n\npm &lt;- read.csv(\"https://data.cdc.gov/resource/7vdq-ztk9.csv?$query=SELECT%0A%20%20%60year%60%2C%0A%20%20%60statefips%60%2C%0A%20%20max(%60pm25_max_pred%60)%20AS%20%60max_pm25_max_pred%60%2C%0A%20%20avg(%60pm25_pop_pred%60)%20AS%20%60avg_pm25_pop_pred%60%0AGROUP%20BY%20%60year%60%2C%20%60statefips%60\")\nozone &lt;- read.csv(\"https://data.cdc.gov/resource/kmf5-t9yc.csv?$query=SELECT%0A%20%20%60year2%60%2C%0A%20%20%60statefips%60%2C%0A%20%20max(%60o3_max_pred%60)%20AS%20%60max_o3_max_pred%60%2C%0A%20%20avg(%60o3_pop_pred%60)%20AS%20%60avg_o3_pop_pred%60%0AGROUP%20BY%20%60year2%60%2C%20%60statefips%60\")\npm$year &lt;- as.numeric(pm$year)\nozone$year2 &lt;- as.numeric(ozone$year2)\n\npm_df &lt;- pm %&gt;% filter(year &gt;= 2002 & year &lt;= 2011)\nozone_df &lt;- ozone %&gt;% filter(year2 &gt;= 2002 & year2 &lt;= 2011)\npm_df &lt;- pm_df[,c('year','statefips','avg_pm25_pop_pred')]\nozone_df &lt;- ozone_df[,c('year2','statefips','avg_o3_pop_pred')]\n\ncancer_df &lt;- lung_df[,c('States.Code','States',\"Year\",\"Count\",\"Population\")]\ncancer_df &lt;- cancer_df %&gt;%\n  group_by(States, Year) %&gt;%\n  mutate(total_cancer_rate = sum(Count, na.rm = TRUE)/sum(Population, na.rm = TRUE) * 100000) %&gt;%\n  ungroup()\ncancer_df &lt;- cancer_df[,c('States.Code','States','Year','total_cancer_rate')]\ncancer_df$total_cancer_rate &lt;- round(cancer_df$total_cancer_rate, 1)\ncancer_df &lt;- cancer_df %&gt;% distinct()\n\nmerged_data &lt;- cancer_df %&gt;%\n  inner_join(pm_df, by = c(\"States.Code\" = \"statefips\", \"Year\" = \"year\"))\nmerged_data &lt;- merged_data %&gt;%\n  inner_join(ozone_df, by = c(\"States.Code\" = \"statefips\", \"Year\" = \"year2\"))\nmerged_data$States &lt;- as.character(merged_data$States)\nwrite.csv(merged_data, \"merged_DATA.csv\")\nhead(merged_data)\n\n\n# A tibble: 6 × 6\n  States.Code States   Year total_cancer_rate avg_pm25_pop_pred avg_o3_pop_pred\n        &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;             &lt;dbl&gt;             &lt;dbl&gt;           &lt;dbl&gt;\n1           1 Alabama  2002              81                11.9            40.8\n2           1 Alabama  2003              79.1              12.3            39.7\n3           1 Alabama  2004              84                12.3            39.6\n4           1 Alabama  2005              82.5              13.1            41.5\n5           1 Alabama  2006              82.7              13.0            44.0\n6           1 Alabama  2007              82.8              13.5            44.0\n\n\n\n3.1.1 Cancer\nWe want to identify long-term increases or decreases in the lung and bronchus cancer incidences for each state in US. The following line plots show that lung and bronchus cancer counts among 100k people is stable from 2001 to 2010 for all states.\n\n\nCode\nresult_by_states &lt;- cancer_df %&gt;%\n  group_by(States, Year) %&gt;%\n  summarize(total_cancer_rate = mean(total_cancer_rate, na.rm = TRUE))\n\n\n`summarise()` has grouped output by 'States'. You can override using the\n`.groups` argument.\n\n\nCode\nggplot(result_by_states, aes(x = Year, y = total_cancer_rate, group = States, color = States)) +\n  geom_line() +\n  labs(title = \"Trend of Cancer Counts by Year and State\",\n       x = \"Year\",\n       y = \"Total Cancer Rate\") +\n  theme_minimal()\n\n\n\n\n\nAfter taking the average of cancer counts among 100k people for all states, we discovered the lung and bronchus cancer counts is first going up and then decrease.\n\n\nCode\nresult_total &lt;- cancer_df %&gt;%\n  group_by(Year) %&gt;%\n  summarize(total_cancer_rate = mean(total_cancer_rate, na.rm = TRUE))\n\nggplot(result_total, aes(x = Year, y = total_cancer_rate)) +\n  geom_point() +\n  labs(title = \"Trend of Average Cancer Rate by Year\",\n       x = \"Year\",\n       y = \"Total Cancer Rate\") +\n  theme_minimal() + \n  geom_smooth(method = \"loess\", span = .7, se = FALSE)\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n3.1.2 pm2.5\nWe want to identify long-term increases or decreases in daily PM2.5 concentrations from 2001 to 2016 for each state in US. The following line plots show that daily PM2.5 concentrations is generally decreasing for all states.\n\n\nCode\nggplot(merged_data, aes(x = Year, y = avg_pm25_pop_pred, color = States)) +\n  geom_line() +\n  labs(title = \"Trend of Daily PM2.5 Concentrations by Year and State\",\n       x = \"Year\",\n       y = \"Daily PM2.5 Concentrations\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\navg_pm_per_year &lt;- pm %&gt;%\n  group_by(year) %&gt;%\n  summarise(average_pm25 = mean(avg_pm25_pop_pred))\n\ng &lt;- ggplot(avg_pm_per_year, aes(year, average_pm25)) +\n  geom_point() +\n  ggtitle(\"Average Daily PM2.5 Concentrations in US, 2001-2016\") +\n  xlab(\"2001-2016\")\ng + geom_smooth(method = \"loess\", span = .5, se = FALSE)\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n3.1.3 Ozone\nWe want to identify long-term increases or decreases in daily Ozone concentrations from 2001 to 2016 for each state in US. The following line plots show no pattern for increasing or decreasing in daily Ozone concentrations for all states. The changes of ozone concentration are subtle.\n\n\nCode\nggplot(merged_data, aes(x = Year, y = avg_o3_pop_pred, color = States)) +\n  geom_line() +\n  labs(title = \"Trend of Daily PM2.5 Concentrations by Year and State\",\n       x = \"Year\",\n       y = \"Daily Ozone Concentrations\") +\n  theme_minimal()\n\n\n\n\n\n\n\nCode\navg_o3_per_year &lt;- ozone %&gt;%\n  group_by(year2) %&gt;%\n  summarise(average_o3 = mean(avg_o3_pop_pred))\ng &lt;- ggplot(avg_o3_per_year, aes(year2, average_o3)) +\n  geom_point() +\n  ggtitle(\"Average Daily Ozone Concentration in US, 2001-2016\") +\n  xlab(\"2001-2016\")\ng + geom_smooth(method = \"loess\", span = .5, se = FALSE)\n\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "results.html#spatial-analysis",
    "href": "results.html#spatial-analysis",
    "title": "3  Results",
    "section": "3.2 Spatial Analysis",
    "text": "3.2 Spatial Analysis\n\n3.2.1 Cancer\nWe want to identify some geographical patterns of lung and bronchus cancer incidences for each state in US. The following choropleth maps use color to indicate the value of cancer incidences within each state. Deep color indicates more cancer incidences. Top states with higher cancer incidences are the same from 2001 to 2011, includes Maine, Kentucky, and West Virginia.\n\n\nCode\nresult_by_states$region &lt;- result_by_states$States\nresult_by_states$value &lt;- result_by_states$total_cancer_rate\n#result_by_states&lt;-result_by_states[,c('region','value','Year')]\nresult_by_states &lt;- na.omit(result_by_states)\nresult_by_states &lt;- result_by_states %&gt;% \n  transmute(region = tolower(`region`), value = value, year = Year)\n\n\n\n\nCode\n# ggplot2 Boxplot\nggplot(result_by_states, aes(x = States, y = value)) +\n  geom_boxplot() +\n  xlab(\"States\") +\n  ylab(\"Total Cancer Rate\") +\n  ggtitle(\"Box Plot of Total Cancer Rate by State\") +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Rotate x-axis labels if needed\n\n\n\n\n\n\n\n3.2.2 PM2.5\nWe want to identify some geographical patterns of PM2.5 concentrations for each state in US. The following choropleth maps use color to indicate the value of population weighted averaged PM2.5 concentrations in μg/m3 for each state. Deep color indicates higher PM2.5 concentrations. Ohio and Indiana have leading PM2.5 concentrations every year from 2001 to 2011. Population weighted average PM2.5 concentrations in alaska and hawaii are not included in the original dataset so they are black on the map.\n\n\nCode\nspatial_pm &lt;- merged_data %&gt;% \n  transmute(region = tolower(States), value = avg_pm25_pop_pred, year = Year)\n\nfor(year in unique(spatial_pm$year)) {\n    df_year &lt;- spatial_pm[spatial_pm$year == year, ]\n    df_year$value &lt;- as.numeric(df_year$value)\n    \n    map &lt;- state_choropleth(df_year, \n                     title = paste(\"Daily Average PM2.5 Concentrations All States, \", year),\n                     legend = \"Daily Average PM2.5\")\n    print(map)\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n3.2.3 Ozone\nWe want to identify some geographical patterns of Ozone concentrations for each state in US. The following choropleth maps use color to indicate the value of population weighted averaged and yearly averaged 8-hour average ozone concentration in parts per billion within 3 meters of the surface of the earth for each state. Deep color indicates higher Ozone concentrations. Utah, Arizona, and New Mexico have leading PM2.5 concentrations every year from 2001 to 2011. Population weighted average Ozone concentrations in alaska and hawaii are not included in the original dataset so they are black on the map.\n\n\nCode\nspatial_o3 &lt;- merged_data %&gt;% \n  transmute(region = tolower(States), value = avg_o3_pop_pred, year = Year)\n\nfor(year in unique(spatial_o3$year)) {\n    df_year &lt;- spatial_o3[spatial_o3$year == year, ]\n    df_year$value &lt;- as.numeric(df_year$value)\n    \n    map &lt;- state_choropleth(df_year, \n                     title = paste(\"Daily Ozone Concentrations All States, \", year),\n                     legend = \"Daily Average PM2.5\")\n    print(map)\n}"
  },
  {
    "objectID": "results.html#correlations-cetween-lung-and-bronchus-cancer-and-pm2.5ozone-concentrations",
    "href": "results.html#correlations-cetween-lung-and-bronchus-cancer-and-pm2.5ozone-concentrations",
    "title": "3  Results",
    "section": "3.3 Correlations Cetween Lung and Bronchus Cancer and PM2.5/Ozone Concentrations",
    "text": "3.3 Correlations Cetween Lung and Bronchus Cancer and PM2.5/Ozone Concentrations\nTo explore how one variable changes with respect to the other between lung and bronchus cancer rates and PM2.5/Ozone concentrations, we used scatter plot, pearson test, and interactive parallel coordinate plot.\nThe following line of best fit in scatter plot shows that lung and bronchus cancer rates and PM2.5 are positively correlated, for most points with higher PM2.5 concentration, it also has higher cancer rate. There are some outliers with low cancer rates but diverse PM2.5 concentration added noise to the fitted line. To know details about those points, we employed interactive scatter plot and discovered that they all belong to Utah. While the average PM2.5 concentration in Utah changed overtime, lung and bronchus cancer rate is consistantly low.\n\n\nCode\nggplot(merged_data, aes(x = avg_pm25_pop_pred, y = total_cancer_rate)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Scatter Plot of Cancer Counts vs PM2.5\", x = \"Average PM2.5\",  y = \"Total Cancer Rate\")\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nCode\nplot_ly(merged_data, x = ~avg_pm25_pop_pred, y = ~total_cancer_rate,\n        color = ~as.factor(Year), text= ~States,\n        hoverinfo = 'text') \n\n\nNo trace type specified:\n  Based on info supplied, a 'scatter' trace seems appropriate.\n  Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter\n\n\nNo scatter mode specifed:\n  Setting the mode to markers\n  Read more about this attribute -&gt; https://plotly.com/r/reference/#scatter-mode\n\n\n\n\n\n\nThe following line of best fit in scatter plot shows barely any correlation between lung and bronchus cancer rates and ozone concentration, for points with high ozone concentration, lung and bronchus cancer rate can be both high or low. There are some outliers that have high ozone concentration level but low cancer rate. The fitted line is slightly downward because of those outliers. To know details about those points, we employed interactive scatter plot and again discovered that they all belong to Utah. While the average ozone concentration in Utah is consistently high comparing to other states, it also has very low lung cancer rates comparing to other states.\n\n\nCode\nggplot(merged_data, aes(x = avg_o3_pop_pred, y = total_cancer_rate)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(title = \"Scatter Plot of Cancer Counts vs Ozone\", \n       x = \"Average Daily Ozone Concentration\",  \n       y = \"Total Cancer Rate\")\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nCode\nplot_ly(merged_data, x = ~avg_o3_pop_pred, y = ~total_cancer_rate,\n        color = ~as.factor(Year), text= ~States,\n        hoverinfo = 'text') \n\n\nNo trace type specified:\n  Based on info supplied, a 'scatter' trace seems appropriate.\n  Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter\n\n\nNo scatter mode specifed:\n  Setting the mode to markers\n  Read more about this attribute -&gt; https://plotly.com/r/reference/#scatter-mode\n\n\n\n\n\n\nThe Pearson correlation test provides a coefficient (r) that quantifies the strength and direction of the linear relationship between two continuous variables. For value close to 1, it indicates positive linear correlation. Based on our data, cancer rates and PM2.5 concentration has correlation 0.4470339. It could be higher without outliers. The p value is 2.2e-16, much smaller than 0.01, which highly suggests that true correlation between lung cancer and PM2.5 concentration is not 0.\n\n\nCode\ncorrelation_test_pearson &lt;- cor.test(merged_data$total_cancer_rate, merged_data$avg_pm25_pop_pred, method = \"pearson\")\nprint(correlation_test_pearson)\n\n\n\n    Pearson's product-moment correlation\n\ndata:  merged_data$total_cancer_rate and merged_data$avg_pm25_pop_pred\nt = 11.028, df = 487, p-value &lt; 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.3731532 0.5152807\nsample estimates:\n      cor \n0.4470339 \n\n\nThen we test the correlation between ozone and cancer rates. Based on our data, cancer rates and ozone concentration has correlation -0.2666176. It could be lower without outliers. The p value is 2.105e-09, much smaller than 0.01, which highly suggests that there is a negative correlation between lung cancer and ozone concentration. However, this finding is strange because ground-level ozone, is “bad” because it can trigger a variety of health problems. So intuitively, there shouldn’t exisit negative correlation between ozone concentration and people’s wellness.\n\n\nCode\ncorrelation_test_pearson &lt;- cor.test(merged_data$total_cancer_rate, merged_data$avg_o3_pop_pred, method = \"pearson\")\nprint(correlation_test_pearson)\n\n\n\n    Pearson's product-moment correlation\n\ndata:  merged_data$total_cancer_rate and merged_data$avg_o3_pop_pred\nt = -6.1047, df = 487, p-value = 2.105e-09\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.3470842 -0.1822541\nsample estimates:\n       cor \n-0.2666176 \n\n\nThe correlation between these variables might be clearer after we removing outliers. To identify outliers, we take at the parallel coordinate graph among cancer rate, PM2.5 concentration, and Ozone concentration. It’s not clear if PM2.5 and Ozone concentration are correlated as some data shows negative relationship and some shows positive. But it’s clear that Utah always has the lowest lung and bronchus cancer rate.\n\n\nCode\nmerged_data %&gt;% \n  select(c(\"States\",\"total_cancer_rate\",\"avg_pm25_pop_pred\",\"avg_o3_pop_pred\")) %&gt;%\n  arrange(merged_data) %&gt;%\n  parcoords(rownames = FALSE,\n            brushMode = \"1D-axes\",\n            color = list(colorBy = \"Region\",\n                         colorScale = \"scaleOrdinal\",\n                         colorScheme = \"schemeCategory10\"),\n            alpha = 0.5,\n            withD3 = TRUE,\n            width = 770,\n            height = 600)\n\n\n\n\n\n\nFrom the graph above, we notice that there are some outliers states, here we using z-score and IQR methods to examine each state, and we notice that Utah, Kentucky, West Virginia are outliers. In the following interactive graph, we will see if removing these states from the data frame will change the regression line of total cancer rate and avergae pm2.5.\n\n\nCode\nz_score &lt;- function(x) {\n  (x - mean(x)) / sd(x)\n}\n\n# Calculate Z-score for each variable\nmerged_data$z_pm25 &lt;- z_score(merged_data$avg_pm25_pop_pred)\nmerged_data$z_cancer_count &lt;- z_score(merged_data$total_cancer_rate)\n\n# Identify outliers (Z-score &gt; 3 or &lt; -3)\noutliers_z &lt;- subset(merged_data, abs(z_pm25) &gt; 3 | abs(z_cancer_count) &gt; 3)\n\niqr_pm25 &lt;- IQR(merged_data$avg_pm25_pop_pred)\niqr_cancer_count &lt;- IQR(merged_data$total_cancer_rate)\n\n# Calculate the bounds\nlower_bound_pm25 &lt;- quantile(merged_data$avg_pm25_pop_pred, 0.25) - 1.5 * iqr_pm25\nupper_bound_pm25 &lt;- quantile(merged_data$avg_pm25_pop_pred, 0.75) + 1.5 * iqr_pm25\nlower_bound_cancer_count &lt;- quantile(merged_data$total_cancer_rate, 0.25) - 1.5 * iqr_cancer_count\nupper_bound_cancer_count &lt;- quantile(merged_data$total_cancer_rate, 0.75) + 1.5 * iqr_cancer_count\n\n# Identify outliers\noutliers_iqr &lt;- subset(merged_data, avg_pm25_pop_pred &lt; lower_bound_pm25 | avg_pm25_pop_pred &gt; upper_bound_pm25 |\n                              total_cancer_rate &lt; lower_bound_cancer_count | total_cancer_rate &gt; upper_bound_cancer_count)\n\ncombined_outliers &lt;- unique(rbind(outliers_z, outliers_iqr))\nprint(unique(combined_outliers$States))\n\n\n[1] \"Utah\"          \"Kentucky\"      \"West Virginia\"\n\n\nFor ozone concentration, we want to see if there is any difference after removing outliers, first we identify for outliers. We notice that Utah and Colorado are two outliers. After removing these states, the correlation become weaker, decreasing from -0.2666176 to -0.09481011. Also, the p-value is 0.04013, which is larger than alpha 0.01, so we cannot reject the null hypothesis. Thus, there is no association between total cancer rate and average ozone concentration.\n\n\nCode\nfiltered_df &lt;- subset(merged_data, !(States %in% c(\"Utah\",\"Colorado\")))\ncorrelation_test_pearson &lt;- cor.test(filtered_df$total_cancer_rate, filtered_df$avg_o3_pop_pred, method = \"pearson\")\nprint(correlation_test_pearson)\n\n\n\n    Pearson's product-moment correlation\n\ndata:  filtered_df$total_cancer_rate and filtered_df$avg_o3_pop_pred\nt = -2.0581, df = 467, p-value = 0.04013\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.183777371 -0.004302126\nsample estimates:\n        cor \n-0.09481011"
  },
  {
    "objectID": "d3graph.html",
    "href": "d3graph.html",
    "title": "4  Interactive graph",
    "section": "",
    "text": "Linear Fitted Line for Ozone vs Lung and Bronchus Cancer\n\n\nClick on the button to see how the fitted line would change if outlier states are excluded.\n\n\n\n\n\n\n\nAll States\n\n\nExclude Colorodo\n\n\nExclude Utah\n\n\nExclude Colorodo and Utah"
  },
  {
    "objectID": "conclusion.html",
    "href": "conclusion.html",
    "title": "5  Conclusion",
    "section": "",
    "text": "In our study, we delve into the intuitive yet complex hypothesis that air quality markedly influences human health, with a particular focus on lung and bronchus health. We propose that superior air quality, defined by reduced PM2.5 levels and reduced ground level ozone concentrations, would be inversely related to the incidence of lung and bronchus cancer.\nOur analysis begins with a detailed examination of state-specific data spanning from 2002 to 2011. Notably, West Virginia emerged as the state with the consistently highest rates of lung cancer, while Texas maintained the lowest rates. Across the spectrum, total cancer rates in various states showed a relatively stable trend, with only marginal increases. Concurrently, air quality data indicated a general downtrend in both average PM2.5 and general stable ozone concentrations during this period.\nThe exploration of the link between total cancer rates and air quality yielded initial findings that were in line with our expectations: a positive correlation between cancer rates and PM2.5 levels, suggesting that poorer air quality could be associated with heightened cancer rates. In contrast, our analysis unexpectedly unveiled a negative correlation between ground level ozone concentration and cancer rates, contradicting our initial hypothesis which anticipated negative impact of higher ground level ozone concentrations.\nA pivotal moment in our research was the adjustment for outliers. The exclusion of data from Utah and Colorado, identified as outliers from the scatter plot, significantly altered our perspective on the ozone-cancer relationship. After this adjustment, we observed no substantial association between ozone concentration and total cancer rates, implying that the initial findings were potentially skewed by unique factors in these outlier states. In our d3 graph, you can click on the button exclude Utah and Colorodo to see the negative correlation or slope getting closer to 0, which again indicates that we cannot conclude ground level ozone concentration and lung cancer rate have negative correlation. This revelation underscores the imperative of rigorous data analysis, particularly in recognizing and accounting for outliers. The instances of Utah and Colorado serve as stark examples of how outliers can dramatically alter initial interpretations, potentially leading to erroneous conclusions.\nA notable limitation of our study is the initial inclusion of outlier states, specifically Utah and Colorado, which initially skewed our understanding of the ozone-cancer relationship. This emphasizes the critical importance of thorough data analysis and consideration of geographical and environmental heterogeneity in epidemiological studies. Looking forward, our study paves the way for more detailed research. Future studies could delve deeper into the specific factors that make states like Utah and Colorado outliers, such as industrial activities, population density, or local environmental policies. Additionally, longitudinal studies could provide more insights into the long-term effects of air quality on cancer rates. In conclusion, while our study offers valuable insights into the relationship between air quality and cancer rates, it also highlights the complexities inherent in environmental health research. The lessons learned about the impact of outliers and the importance of comprehensive data analysis are invaluable for guiding future studies in this vital field."
  }
]